2025-12-27 18:04:57,401 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 150, 'batch_size': 512, 'save_model': True, 'log_loss': False, 'test_step': 1, 'reproducible': True, 'seed': 2023, 'early_stop': True, 'patience': 20}, 'test': {'metrics': ['mrr', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 512}, 'data': {'type': 'sequential', 'name': 'music', 'seq_aug': True, 'dir': './datasets/sequential/music_seq/', 'user_num': 71275, 'item_num': 73371}, 'model': {'name': 'mgrec', 'dropout_rate': 0.1, 'graph_dropout_prob': 0.3, 'n_layers': 2, 'embedding_size': 64, 'n_heads': 2, 'max_seq_len': 50, 'cl_lambda': 0.0001, 'cl_temp': 0.8, 'weight_mean': 0.4, 'sim_group_k': 4, 'kl_weight': 0.01}, 'tune': {'enable': False, 'hyperparameters': ['cl_lambda', 'weight_mean'], 'cl_lambda': [0.0001, 0.001, 0.01], 'weight_mean': [0.4, 0.5, 0.6]}, 'bre': {'bre_model_name': 'bert-base-uncased', 'bre_max_len': 256, 'out_dim': 64, 'dropout': 0.2, 'bre_freeze_bert': True, 'bre_pooling': 'mean', 'bre_normalize': True}, 'device': 'cuda'}
2025-12-27 18:40:33,878 - expected Tensor as element 0 in argument 0, but got int
Traceback (most recent call last):
  File "/workspace/MGRec/trainer/utils.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/MGRec/trainer/trainer.py", line 147, in evaluate
    eval_result = self.metric.eval(model, self.data_handler.test_dataloader)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/MGRec/trainer/metrics.py", line 95, in eval
    for _, tem in enumerate(test_dataloader):
  File "/venv/myenv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/venv/myenv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/myenv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/MGRec/data_utils/data_handler_sequential.py", line 105, in collate_fn
    uid = torch.stack([item[0] for item in batch])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected Tensor as element 0 in argument 0, but got int
2025-12-27 18:40:33,882 - expected Tensor as element 0 in argument 0, but got int
Traceback (most recent call last):
  File "/workspace/MGRec/trainer/utils.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/MGRec/trainer/trainer.py", line 112, in train
    eval_result = self.evaluate(model, epoch_idx)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/MGRec/trainer/utils.py", line 18, in wrapper
    raise e
  File "/workspace/MGRec/trainer/utils.py", line 15, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/MGRec/trainer/trainer.py", line 147, in evaluate
    eval_result = self.metric.eval(model, self.data_handler.test_dataloader)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/MGRec/trainer/metrics.py", line 95, in eval
    for _, tem in enumerate(test_dataloader):
  File "/venv/myenv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/venv/myenv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/venv/myenv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/MGRec/data_utils/data_handler_sequential.py", line 105, in collate_fn
    uid = torch.stack([item[0] for item in batch])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected Tensor as element 0 in argument 0, but got int
